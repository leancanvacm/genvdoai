<!DOCTYPE html>
<html lang="th" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gen VDO จาก Prompt | Kie.ai</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            500: '#6366f1',
                            600: '#4f46e5',
                        },
                        dark: {
                            800: '#1e293b',
                            900: '#0f172a',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>
<body class="bg-dark-900 text-gray-200 min-h-screen flex flex-col">
    <div class="container mx-auto px-4 py-8 max-w-3xl">
        <h1 class="text-3xl font-bold text-center mb-8 text-white">Gen VDO จาก Prompt</h1>

        <!-- Input Section -->
        <div class="bg-dark-800 rounded-lg p-6 mb-6 shadow-lg">
            <div class="mb-4">
                <label for="apiKey" class="block text-sm font-medium mb-2">API Key</label>
                <input type="text" id="apiKey" class="w-full p-3 rounded bg-dark-900 border border-gray-600 focus:ring-primary-500 focus:border-primary-500" placeholder="10757e71946cb1a904cf4c2632f221ce">
            </div>
            <div class="mb-4">
                <label for="prompt" class="block text-sm font-medium mb-2">Prompt ข้อความ</label>
                <textarea id="prompt" rows="4" class="w-full p-3 rounded bg-dark-900 border border-gray-600 focus:ring-primary-500 focus:border-primary-500" placeholder="พิมพ์ prompt ของคุณที่นี่..."></textarea>
            </div>
            <div class="flex space-x-4">
                <div class="flex-1">
                    <label for="aspectRatio" class="block text-sm font-medium mb-2">Aspect Ratio</label>
                    <select id="aspectRatio" class="w-full p-3 rounded bg-dark-900 border border-gray-600 focus:ring-primary-500 focus:border-primary-500">
                        <option value="landscape">Landscape</option>
                        <option value="portrait">Portrait</option>
                        <option value="square">Square</option>
                    </select>
                </div>
                <div class="flex-1">
                    <label for="frames" class="block text-sm font-medium mb-2">จำนวนเฟรม</label>
                    <input type="number" id="frames" value="10" min="1" max="60" class="w-full p-3 rounded bg-dark-900 border border-gray-600 focus:ring-primary-500 focus:border-primary-500">
                </div>
            </div>
            <button id="generateBtn" class="mt-6 w-full bg-primary-600 hover:bg-primary-500 text-white py-3 px-4 rounded transition duration-200">
                สร้างวิดีโอ
            </button>
        </div>

        <!-- Result Section -->
        <div id="resultSection" class="bg-dark-800 rounded-lg p-6 hidden">
            <h2 class="text-xl font-semibold mb-4">ผลลัพธ์</h2>
            <div id="videoContainer" class="mb-4 aspect-video bg-black rounded overflow-hidden">
                <!-- Video will be inserted here -->
            </div>
            <div class="flex space-x-4">
                <button id="playBtn" class="flex-1 bg-green-600 hover:bg-green-500 text-white py-2 px-4 rounded transition duration-200">
                    เล่นวิดีโอ
                </button>
                <button id="downloadBtn" class="flex-1 bg-blue-600 hover:bg-blue-500 text-white py-2 px-4 rounded transition duration-200">
                    ดาวน์โหลด
                </button>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alertModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-dark-800 rounded-lg p-6 max-w-md mx-4 shadow-xl border border-gray-600">
            <div class="flex items-start">
                <div class="flex-shrink-0">
                    <svg id="alertIcon" class="h-6 w-6 text-green-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                </div>
                <div class="ml-3">
                    <h3 id="alertTitle" class="text-lg font-medium text-white">สำเร็จ!</h3>
                    <div id="alertMessage" class="mt-2 text-gray-300">
                        วิดีโอของคุณพร้อมแล้ว
                    </div>
                </div>
            </div>
            <div class="mt-4 flex justify-end">
                <button id="alertCloseBtn" class="bg-gray-600 hover:bg-gray-500 text-white py-2 px-4 rounded transition duration-200">
                    ตกลง
                </button>
            </div>
        </div>

    <script>
        // DOM Elements
        const apiKeyInput = document.getElementById('apiKey');
        const promptInput = document.getElementById('prompt');
        const aspectRatioSelect = document.getElementById('aspectRatio');
        const framesInput = document.getElementById('frames');
        const generateBtn = document.getElementById('generateBtn');
        const resultSection = document.getElementById('resultSection');
        const videoContainer = document.getElementById('videoContainer');
        const playBtn = document.getElementById('playBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const alertModal = document.getElementById('alertModal');
        const alertTitle = document.getElementById('alertTitle');
        const alertMessage = document.getElementById('alertMessage');
        const alertCloseBtn = document.getElementById('alertCloseBtn');
        const alertIcon = document.getElementById('alertIcon');

        // Variables
        let videoBlob = null;
        let videoUrl = null;

        // Generate Video
        generateBtn.addEventListener('click', async () => {
            const apiKey = apiKeyInput.value.trim();
            const prompt = promptInput.value.trim();
            const aspectRatio = aspectRatioSelect.value;
            const nFrames = framesInput.value;

            if (!apiKey || !prompt) {
                showAlert('ข้อผิดพลาด', 'กรุณากรอก API Key และ Prompt', 'error');
                return;
            }

            generateBtn.disabled = true;
            generateBtn.textContent = 'กำลังสร้าง...';

            try {
                const response = await fetch('https://api.kie.ai/api/v1/jobs/createTask', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: "sora-2-text-to-video",
                        input: {
                            prompt: prompt,
                            aspect_ratio: aspectRatio,
                            n_frames: nFrames
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();

                // Simulate video generation (in real app, you would poll for job completion)
                // For demo purposes, we'll use a placeholder video
                setTimeout(() => {
                    // In a real app, you would get the video URL from the API response
                    // and use that to display and download the video
                    videoUrl = 'https://example.com/generated-video.mp4'; // Replace with actual video URL from API
                    displayVideo(videoUrl);
                    showAlert('สำเร็จ', 'วิดีโอของคุณพร้อมแล้ว', 'success');
                }, 2000);

            } catch (error) {
                console.error('Error:', error);
                showAlert('ข้อผิดพลาด', `ไม่สามารถสร้างวิดีโอได้: ${error.message}`, 'error');
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'สร้างวิดีโอ';
            }
        });

        // Display Video
        function displayVideo(url) {
            videoContainer.innerHTML = `
                <video id="generatedVideo" controls class="w-full h-full object-contain">
                    <source src="${url}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            `;
            resultSection.classList.remove('hidden');
        }

        // Play Video
        playBtn.addEventListener('click', () => {
            const video = document.getElementById('generatedVideo');
            if (video) {
                video.play();
            }
        });

        // Download Video
        downloadBtn.addEventListener('click', () => {
            if (videoUrl) {
                const link = document.createElement('a');
                link.href = videoUrl;
                link.download = 'generated-video.mp4';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showAlert('ดาวน์โหลด', 'เริ่มดาวน์โหลดวิดีโอ', 'success');
            }
        });

        // Show Alert
        function showAlert(title, message, type) {
            alertTitle.textContent = title;
            alertMessage.textContent = message;

            if (type === 'error') {
                alertIcon.className = 'h-6 w-6 text-red-400';
                alertIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                `;
            } else {
                alertIcon.className = 'h-6 w-6 text-green-400';
                alertIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                `;
            }

            alertModal.classList.remove('hidden');
        }

        // Close Alert
        alertCloseBtn.addEventListener('click', () => {
            alertModal.classList.add('hidden');
        });

        // Close alert when clicking outside
        alertModal.addEventListener('click', (e) => {
            if (e.target === alertModal) {
                alertModal.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
